# Figure 2                                                                      
This readme contains the script and input files to generate figure 2 from our manuscript, "PopInf: An approach for reproducibly visualizing and assigning population affiliation in genomic samples of uncertain origin"

## GTEx HeatMaps

The following script will produce the figure that showcases the inferred population of all of the GTEx samples by assigning a unique color to each population group. This script utilizes the inferred ancestry reports generated by PopInf.

Ensure that the script and the input files are in the same directory. We have provided the input files used to make the figure in the manuscript in the "`INPUTS`" folder.

To run the script, run the following command:

```
Rscript GTEx_Heatmaps.R
```

## GTEx Additional Figures

The following script will produce the figure that showcases the inferred populations for the chromosomes that have different inferred populations across the chromosomes.  This script utilizes the inferred ancestry reports generated by PopInf.

Ensure that the script and the input files are in the same directory. We have provided the input files used to make the figure in the manuscript in the "`INPUTS`" folder.

### Step 1: Generate the Chromosomal Variation File

First, we have the generate the file that identifies which samples have different inferred populations across the chromosomes.

To do this, run the following command:

```
Rscript GTEx_Generate_Chromosomal_Variation.R
```

This script generates an excel file that must be manually manipulated to identify the samples with different inferred populations across the chromosomes. We changed the file by deleting the sample rows with uniform inferred populations across the chromosome.

### Step 2: Generate the Figure

Ensure that the edited chromosomal variation excel file is in the same directory as the script and the input files.

Then, run the following command:

``` 
Rscript GTEx_Additional_Heatmaps.R
```

## TCGA HeatMaps

The following script will produce the figure that showcases the inferred population of all of the GTEx samples by assigning a unique color to each population group. This script utilizes the inferred ancestry reports generated by PopInf.

Ensure that the script and the input files are in the same directory. We have provided the input files used to make the figure in the manuscript in the "`INPUTS`" folder.

To run the script, run the following command:

```
Rscript TCGA_Heatmaps.R
```

## TCGA Additional Figures

The following script will produce the figure that showcases the inferred populations for the chromosomes that have different inferred populations across the chromosomes.  This script utilizes the inferred ancestry reports generated by PopInf.

Ensure that the script and the input files are in the same directory. We have provided the input files used to make the figure in the manuscript in the "`INPUTS`" folder.

### Step 1: Generate the Chromosomal Variation File

First, we have the generate the file that identifies which samples have different inferred populations across the chromosomes.

To do this, run the following command:

```
Rscript TCGA_Generate_Chromosomal_Variation.R
```

This script generates an excel file that must be manually manipulated to identify the samples with different inferred populations across the chromosomes. We changed the file by deleting the sample rows with uniform inferred populations across the chromosome.

### Step 2: Generate the Figure

Ensure that the edited chromosomal variation excel file is in the same directory as the script and the input files.

Then, run the following command:

``` 
Rscript TCGA_Additional_Heatmaps.R
```
